import React, { useState } from 'react';
import { Search, Home, Book, Heart, User, ChefHat, X, Clock, Users, Flame } from 'lucide-react';

const App = () => {
  const [activeTab, setActiveTab] = useState('home');
  const [favorites, setFavorites] = useState([]);
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedRecipe, setSelectedRecipe] = useState(null);

  const categories = [
    {
      id: 'vegetables',
      title: 'Sayur',
      subtitle: 'Aneka Sayuran',
      icon: 'ü•¶',
      color: 'bg-green-100',
      textColor: 'text-green-600'
    },
    {
      id: 'meat',
      title: 'Dagian',
      subtitle: 'Dagin',
      icon: 'ü•©',
      color: 'bg-red-100',
      textColor: 'text-red-600'
    },
    {
      id: 'fruits',
      title: 'Buah-buahan',
      subtitle: 'Segar',
      icon: 'üçé',
      color: 'bg-orange-100',
      textColor: 'text-orange-600'
    },
    {
      id: 'chicken',
      title: 'Ayam',
      subtitle: 'Masakan Ayam',
      icon: 'üçó',
      color: 'bg-yellow-100',
      textColor: 'text-yellow-700'
    }
  ];

  const recipes = [
    {
      id: 1,
      name: 'Nasi Goreng Senyum',
      image: 'üçú',
      color: 'bg-green-50',
      category: 'vegetables',
      time: '25 menit',
      servings: '2 porsi',
      difficulty: 'Mudah',
      nutrition: {
        calories: 450,
        protein: '12g',
        carbs: '65g',
        fat: '15g'
      },
      ingredients: [
        '2 piring nasi putih',
        '2 butir telur',
        '3 siung bawang putih',
        '2 batang daun bawang',
        'Kecap manis secukupnya',
        'Garam dan merica',
        'Minyak goreng'
      ],
      steps: [
        'Panaskan minyak dalam wajan',
        'Tumis bawang putih hingga harum',
        'Masukkan telur, orak-arik hingga matang',
        'Tambahkan nasi putih, aduk rata',
        'Beri kecap manis, garam, dan merica',
        'Masak sambil diaduk hingga bumbu merata',
        'Taburi daun bawang, sajikan hangat'
      ]
    },
    {
      id: 2,
      name: 'Sup Krim Jagung Ceria',
      image: 'üç≤',
      color: 'bg-red-50',
      category: 'vegetables',
      time: '30 menit',
      servings: '4 porsi',
      difficulty: 'Mudah',
      nutrition: {
        calories: 220,
        protein: '8g',
        carbs: '35g',
        fat: '6g'
      },
      ingredients: [
        '2 bonggol jagung manis',
        '500ml susu cair',
        '2 sdm mentega',
        '1 bawang bombay',
        'Garam dan merica',
        'Daun bawang untuk taburan',
        'Keju parut (opsional)'
      ],
      steps: [
        'Pipil jagung dari bonggolnya',
        'Tumis bawang bombay dengan mentega hingga harum',
        'Masukkan jagung, masak 5 menit',
        'Tuang susu cair, didihkan',
        'Blender setengah adonan hingga halus',
        'Campur kembali, tambah garam dan merica',
        'Sajikan dengan taburan daun bawang dan keju'
      ]
    },
    {
      id: 3,
      name: 'Ayam Geprek Gembira',
      image: 'üçõ',
      color: 'bg-orange-50',
      category: 'chicken',
      time: '40 menit',
      servings: '2 porsi',
      difficulty: 'Sedang',
      nutrition: {
        calories: 520,
        protein: '35g',
        carbs: '25g',
        fat: '28g'
      },
      ingredients: [
        '2 potong dada ayam',
        '10 cabai rawit',
        '5 siung bawang putih',
        'Tepung bumbu serbaguna',
        'Garam dan gula',
        'Minyak untuk menggoreng',
        'Daun jeruk'
      ],
      steps: [
        'Marinasi ayam dengan garam, diamkan 15 menit',
        'Balur ayam dengan tepung bumbu',
        'Goreng ayam hingga kecoklatan dan matang',
        'Ulek cabai, bawang putih, garam, dan gula',
        'Geprek ayam goreng dengan sambal',
        'Tambahkan daun jeruk, aduk rata',
        'Sajikan dengan nasi hangat'
      ]
    },
    {
      id: 4,
      name: 'Sate Ayam Manis',
      image: 'üç¢',
      color: 'bg-yellow-50',
      category: 'chicken',
      time: '35 menit',
      servings: '3 porsi',
      difficulty: 'Mudah',
      nutrition: {
        calories: 380,
        protein: '32g',
        carbs: '18g',
        fat: '20g'
      },
      ingredients: [
        '500g daging ayam fillet',
        '4 sdm kecap manis',
        '2 sdm minyak wijen',
        '3 siung bawang putih',
        'Tusuk sate',
        'Margarin untuk olesan',
        'Jeruk nipis'
      ],
      steps: [
        'Potong ayam dadu, marinasi dengan bumbu',
        'Diamkan dalam kulkas 30 menit',
        'Tusuk ayam dengan tusuk sate',
        'Panaskan grill atau bara api',
        'Bakar sate sambil dioles margarin',
        'Balik-balik hingga matang merata',
        'Sajikan dengan kecap dan jeruk nipis'
      ]
    },
    {
      id: 5,
      name: 'Capcay Sayur Segar',
      image: 'ü•ó',
      color: 'bg-pink-50',
      category: 'vegetables',
      time: '20 menit',
      servings: '3 porsi',
      difficulty: 'Mudah',
      nutrition: {
        calories: 180,
        protein: '6g',
        carbs: '28g',
        fat: '5g'
      },
      ingredients: [
        'Wortel 1 buah',
        'Brokoli 100g',
        'Kembang kol 100g',
        'Buncis 50g',
        'Jagung muda 3 buah',
        'Bawang putih 3 siung',
        'Saus tiram 2 sdm'
      ],
      steps: [
        'Potong semua sayuran sesuai selera',
        'Rebus sayuran sebentar hingga setengah matang',
        'Tumis bawang putih hingga harum',
        'Masukkan semua sayuran',
        'Tambahkan saus tiram, garam, gula',
        'Aduk cepat dengan api besar',
        'Sajikan selagi hangat'
      ]
    },
    {
      id: 6,
      name: 'Sop Buah Segar',
      image: 'üç®',
      color: 'bg-purple-50',
      category: 'fruits',
      time: '15 menit',
      servings: '4 porsi',
      difficulty: 'Sangat Mudah',
      nutrition: {
        calories: 150,
        protein: '3g',
        carbs: '32g',
        fat: '2g'
      },
      ingredients: [
        'Melon 200g',
        'Nanas 150g',
        'Apel 1 buah',
        'Anggur secukupnya',
        'Sirup cocopandan',
        'Susu kental manis',
        'Es batu'
      ],
      steps: [
        'Potong dadu semua buah',
        'Masukkan buah dalam mangkuk besar',
        'Tambahkan sirup cocopandan',
        'Tuang susu kental manis sesuai selera',
        'Aduk rata semua bahan',
        'Tambahkan es batu',
        'Sajikan segera selagi dingin'
      ]
    }
  ];

  const toggleFavorite = (recipeId) => {
    setFavorites(prev => 
      prev.includes(recipeId) 
        ? prev.filter(id => id !== recipeId)
        : [...prev, recipeId]
    );
  };

  const [selectedCategory, setSelectedCategory] = useState(null);

  const filteredRecipes = recipes.filter(recipe => {
    const matchesSearch = recipe.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                         recipe.ingredients.some(ing => ing.toLowerCase().includes(searchQuery.toLowerCase()));
    const matchesCategory = !selectedCategory || recipe.category === selectedCategory;
    return matchesSearch && matchesCategory;
  });

  const displayedRecipes = activeTab === 'favorites' 
    ? recipes.filter(r => favorites.includes(r.id))
    : filteredRecipes;

  const RecipeDetail = ({ recipe }) => {
    if (!recipe) return null;

    return (
      <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto">
        <div className="bg-white rounded-3xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
          {/* Header */}
          <div className={`${recipe.color} p-6 rounded-t-3xl relative`}>
            <button
              onClick={() => setSelectedRecipe(null)}
              className="absolute top-4 right-4 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100"
            >
              <X className="w-6 h-6 text-gray-700" />
            </button>
            <div className="text-center">
              <div className="text-8xl mb-4">{recipe.image}</div>
              <h2 className="text-3xl font-bold text-gray-800 mb-2">{recipe.name}</h2>
              <div className="flex justify-center gap-4 text-sm text-gray-600">
                <span className="flex items-center gap-1">
                  <Clock className="w-4 h-4" /> {recipe.time}
                </span>
                <span className="flex items-center gap-1">
                  <Users className="w-4 h-4" /> {recipe.servings}
                </span>
                <span className="bg-white px-3 py-1 rounded-full">
                  {recipe.difficulty}
                </span>
              </div>
            </div>
          </div>

          {/* Content */}
          <div className="p-6">
            {/* Nutrition */}
            <div className="mb-6">
              <h3 className="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                <Flame className="w-5 h-5 text-orange-500" />
                Informasi Nutrisi
              </h3>
              <div className="grid grid-cols-4 gap-3">
                <div className="bg-orange-50 rounded-xl p-3 text-center">
                  <p className="text-2xl font-bold text-orange-600">{recipe.nutrition.calories}</p>
                  <p className="text-xs text-gray-600">Kalori</p>
                </div>
                <div className="bg-blue-50 rounded-xl p-3 text-center">
                  <p className="text-2xl font-bold text-blue-600">{recipe.nutrition.protein}</p>
                  <p className="text-xs text-gray-600">Protein</p>
                </div>
                <div className="bg-green-50 rounded-xl p-3 text-center">
                  <p className="text-2xl font-bold text-green-600">{recipe.nutrition.carbs}</p>
                  <p className="text-xs text-gray-600">Karbo</p>
                </div>
                <div className="bg-yellow-50 rounded-xl p-3 text-center">
                  <p className="text-2xl font-bold text-yellow-600">{recipe.nutrition.fat}</p>
                  <p className="text-xs text-gray-600">Lemak</p>
                </div>
              </div>
            </div>

            {/* Ingredients */}
            <div className="mb-6">
              <h3 className="text-xl font-bold text-gray-800 mb-3">üõí Bahan-Bahan</h3>
              <div className="bg-gray-50 rounded-xl p-4">
                <ul className="space-y-2">
                  {recipe.ingredients.map((ingredient, index) => (
                    <li key={index} className="flex items-start gap-2">
                      <span className="text-green-500 mt-1">‚úì</span>
                      <span className="text-gray-700">{ingredient}</span>
                    </li>
                  ))}
                </ul>
              </div>
            </div>

            {/* Steps */}
            <div className="mb-6">
              <h3 className="text-xl font-bold text-gray-800 mb-3">üë®‚Äçüç≥ Cara Membuat</h3>
              <div className="space-y-3">
                {recipe.steps.map((step, index) => (
                  <div key={index} className="flex gap-3">
                    <div className="flex-shrink-0 w-8 h-8 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center text-white font-bold text-sm">
                      {index + 1}
                    </div>
                    <p className="text-gray-700 pt-1">{step}</p>
                  </div>
                ))}
              </div>
            </div>

            {/* Action Button */}
            <button
              onClick={() => toggleFavorite(recipe.id)}
              className={`w-full py-4 rounded-xl font-bold text-lg transition ${
                favorites.includes(recipe.id)
                  ? 'bg-red-500 text-white'
                  : 'bg-gradient-to-r from-amber-400 to-orange-500 text-white'
              }`}
            >
              {favorites.includes(recipe.id) ? '‚ù§Ô∏è Hapus dari Favorit' : '‚ù§Ô∏è Tambah ke Favorit'}
            </button>
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="min-h-screen bg-gradient-to-b from-amber-50 to-orange-50 pb-20">
      {/* Header */}
      <div className="bg-white shadow-sm sticky top-0 z-10">
        <div className="max-w-4xl mx-auto px-6 py-6">
          <h1 className="text-4xl font-bold text-center mb-6" style={{
            color: '#8B4513',
            textShadow: '2px 2px 4px rgba(0,0,0,0.1)',
            fontFamily: 'system-ui, -apple-system, sans-serif'
          }}>
            DapurBahagia
          </h1>
          
          {/* Search Bar */}
          <div className="relative">
            <Search className="absolute left-4 top-1/2 transform -translate-y-1/2 text-amber-700 w-5 h-5" />
            <input
              type="text"
              placeholder="Cari Resep Seru..."
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
              className="w-full pl-12 pr-4 py-3 rounded-full bg-amber-50 border-2 border-amber-100 focus:outline-none focus:border-amber-300 text-gray-700 placeholder-amber-600"
            />
          </div>
        </div>
      </div>

      {/* Main Content */}
      <div className="max-w-4xl mx-auto px-6 py-6">
        {activeTab === 'home' && (
          <>
            {/* Categories */}
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
              {categories.map((category) => (
                <div
                  key={category.id}
                  onClick={() => {
                    setSelectedCategory(selectedCategory === category.id ? null : category.id);
                    setActiveTab('recipes');
                  }}
                  className={`${category.color} rounded-3xl p-6 text-center cursor-pointer transform transition hover:scale-105 shadow-md ${
                    selectedCategory === category.id ? 'ring-4 ring-amber-400' : ''
                  }`}
                >
                  <div className="text-6xl mb-3">{category.icon}</div>
                  <h3 className={`font-bold text-lg ${category.textColor}`}>
                    {category.title}
                  </h3>
                  <p className="text-sm text-gray-600">{category.subtitle}</p>
                  {selectedCategory === category.id && (
                    <div className="mt-2 text-xs bg-white rounded-full px-3 py-1 inline-block">
                      ‚úì Dipilih
                    </div>
                  )}
                </div>
              ))}
            </div>

            {/* Today's Recipes */}
            <h2 className="text-2xl font-bold text-gray-800 mb-4">
              Resep Pilihan Hari Ini!
            </h2>
          </>
        )}

        {activeTab === 'recipes' && (
          <>
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-2xl font-bold text-gray-800">
                {selectedCategory 
                  ? `Resep ${categories.find(c => c.id === selectedCategory)?.title}`
                  : 'Semua Resep'
                }
              </h2>
              {selectedCategory && (
                <button
                  onClick={() => setSelectedCategory(null)}
                  className="text-sm bg-amber-100 hover:bg-amber-200 text-amber-700 px-4 py-2 rounded-full transition"
                >
                  Lihat Semua
                </button>
              )}
            </div>
            {searchQuery && (
              <p className="text-sm text-gray-600 mb-4">
                Hasil pencarian untuk "{searchQuery}" - {displayedRecipes.length} resep ditemukan
              </p>
            )}
          </>
        )}

        {activeTab === 'favorites' && (
          <>
            <h2 className="text-2xl font-bold text-gray-800 mb-4">
              Resep Favorit
            </h2>
            {favorites.length > 0 && (
              <p className="text-sm text-gray-600 mb-4">
                Kamu punya {favorites.length} resep favorit
              </p>
            )}
          </>
        )}

        {activeTab === 'profile' && (
          <div className="text-center py-12">
            <div className="w-24 h-24 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center">
              <User className="w-12 h-12 text-white" />
            </div>
            <h2 className="text-2xl font-bold text-gray-800 mb-2">Profile Saya</h2>
            <p className="text-gray-600">Selamat datang di DapurBahagia!</p>
            <div className="mt-8 space-y-3 max-w-xs mx-auto">
              <div className="bg-white rounded-lg p-4 shadow-sm">
                <p className="text-gray-600">Total Resep Favorit</p>
                <p className="text-3xl font-bold text-amber-600">{favorites.length}</p>
              </div>
            </div>
          </div>
        )}

        {/* Recipe Cards */}
        {(activeTab === 'home' || activeTab === 'recipes' || activeTab === 'favorites') && (
          <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
            {displayedRecipes.map((recipe) => (
              <div
                key={recipe.id}
                className={`${recipe.color} rounded-2xl p-4 shadow-md transform transition hover:scale-105 cursor-pointer`}
                onClick={() => setSelectedRecipe(recipe)}
              >
                <div className="aspect-square flex items-center justify-center mb-3 text-7xl">
                  {recipe.image}
                </div>
                <h3 className="font-semibold text-center text-gray-800 mb-2 text-sm">
                  {recipe.name}
                </h3>
                <div className="flex items-center justify-center gap-2 text-xs text-gray-600 mb-3">
                  <span className="flex items-center gap-1">
                    <Clock className="w-3 h-3" /> {recipe.time}
                  </span>
                </div>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    setSelectedRecipe(recipe);
                  }}
                  className="w-full py-2 rounded-lg font-medium transition bg-white text-amber-600 border-2 border-amber-500 hover:bg-amber-500 hover:text-white"
                >
                  Lihat Resep
                </button>
              </div>
            ))}
          </div>
        )}

        {displayedRecipes.length === 0 && activeTab === 'favorites' && (
          <div className="text-center py-12 text-gray-500">
            <Heart className="w-16 h-16 mx-auto mb-4 opacity-50" />
            <p>Belum ada resep favorit</p>
          </div>
        )}

        {displayedRecipes.length === 0 && searchQuery && (
          <div className="text-center py-12 text-gray-500">
            <Search className="w-16 h-16 mx-auto mb-4 opacity-50" />
            <p>Resep tidak ditemukan</p>
          </div>
        )}
      </div>

      {/* Bottom Navigation */}
      <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg">
        <div className="max-w-4xl mx-auto px-6 py-3">
          <div className="flex justify-around items-center">
            <button
              onClick={() => {
                setActiveTab('home');
                setSelectedCategory(null);
                setSearchQuery('');
              }}
              className={`flex flex-col items-center space-y-1 ${
                activeTab === 'home' ? 'text-green-600' : 'text-gray-400'
              }`}
            >
              <Home className="w-6 h-6" />
              <span className="text-xs font-medium">Beranda</span>
            </button>
            
            <button
              onClick={() => {
                setActiveTab('recipes');
                setSelectedCategory(null);
              }}
              className={`flex flex-col items-center space-y-1 ${
                activeTab === 'recipes' ? 'text-blue-600' : 'text-gray-400'
              }`}
            >
              <Book className="w-6 h-6" />
              <span className="text-xs font-medium">Resepku</span>
            </button>
            
            <button
              onClick={() => setActiveTab('favorites')}
              className={`flex flex-col items-center space-y-1 ${
                activeTab === 'favorites' ? 'text-red-600' : 'text-gray-400'
              }`}
            >
              <Heart className="w-6 h-6" />
              <span className="text-xs font-medium">Favorit</span>
            </button>
            
            <button
              onClick={() => setActiveTab('profile')}
              className={`flex flex-col items-center space-y-1 ${
                activeTab === 'profile' ? 'text-purple-600' : 'text-gray-400'
              }`}
            >
              <ChefHat className="w-6 h-6" />
              <span className="text-xs font-medium">Profil</span>
            </button>
          </div>
        </div>
      </div>

      {/* Recipe Detail Modal */}
      {selectedRecipe && <RecipeDetail recipe={selectedRecipe} />}
    </div>
  );
};

export default App;
